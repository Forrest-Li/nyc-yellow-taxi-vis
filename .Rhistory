mta_tax = yellow_june$mta_tax,
tip_amount = yellow_june$tip_amount,
tolls_amount = yellow_june$tolls_amount,
improvement_surcharge = yellow_june$improvement_surcharge,
total_amount = yellow_june$total_amount
)
# mutate day_time part
yellow_june_test <- yellow_june_test %>% mutate(isWeekend = vec_isWeekend)
yellow_june_test <- yellow_june_test %>% mutate(weekendTime = 99)
yellow_june_test$weekendTime[vec_weekend_index] <- vec_weekendTime
yellow_june_test$weekendTime <- as.factor(yellow_june_test$weekendTime)
yellow_june_test <- yellow_june_test %>% mutate(workTime = 99)
yellow_june_test$workTime[vec_workday_index] <- vec_workdayTime
yellow_june_test$workTime <- as.factor(yellow_june_test$workTime)
########## Data Cleaning ##########
# drop invalid coordinate tuples
# range = c(-74.05, 40.54, -73.70001, 40.91553)
yellow_june_cleaned <- yellow_june_test %>%
filter(pickup_latitude   >=  40.54, pickup_latitude   <=  40.91553,
pickup_longitude  >= -74.05, pickup_longitude  <= -73.70001,
dropoff_latitude  >=  40.54, dropoff_latitude  <=  40.91553,
dropoff_longitude >= -74.05, dropoff_longitude <= -73.70001)
View(yellow_june_cleaned)
runApp('D:/finalProjectData/RShiny/NYCTaxiVis')
runApp('D:/finalProjectData/RShiny/NYCTaxiVis')
runApp('D:/finalProjectData/RShiny/NYCTaxiVis')
# slicing by time in a day
sel_isWeekend <- 0#as.numeric(sel_item1)
sel_weekday <- C("mon")#sel_item2
sel_timeInDay <- c("work_midnight", "work_on_work", "work_whiteday", "work_off_work", "work_night")#sel_item3
sel_weekday <- C("mon", "tue")#sel_item2
sel_weekday <- c("mon")#sel_item2
sel_timeInDay <- c("work_midnight", "work_on_work", "work_whiteday", "work_off_work", "work_night")#sel_item3
# filter by restricting conditions
yellow_cleaned_type2 <- if(sel_isWeekend == 2){ # mixed
filter(df_data,
pickup_weekday %in% sel_weekday)
}else if(sel_isWeekend == 0){ # weekday
filter(df_data,
isWeekend == FALSE,
workTime %in% sel_timeInDay)
}else{#(sel_isWeekend == 1){ # weekend
filter(yellow_june_cleaned, #df_data,
isWeekend == TRUE,
pickup_weekday %in% sel_weekday,
weekendTime %in% sel_timeInDay)
}
View(yellow_cleaned_type2)
# filter by restricting conditions
yellow_cleaned_type2 <- if(sel_isWeekend == 2){ # mixed
filter(df_data,
pickup_weekday %in% sel_weekday)
}else if(sel_isWeekend == 0){ # weekday
filter(yellow_june_cleaned,
isWeekend == FALSE,
pickup_weekday %in% sel_weekday,
workTime %in% sel_timeInDay)
}else{#(sel_isWeekend == 1){ # weekend
filter(yellow_june_cleaned, #df_data,
isWeekend == TRUE,
pickup_weekday %in% sel_weekday,
weekendTime %in% sel_timeInDay)
}
View(yellow_cleaned_type2)
## summarise by hours
cnt_df_hour <- yellow_cleaned_type2 %>%
group_by(pickup_weekday, pickup_hour) %>%
count(pickup_hour) %>%
arrange(pickup_weekday, pickup_hour)
colnames(cnt_df_hour)[3] <- "freq"
cnt_df_hour <- cbind(combined_time = paste(cnt_df_hour$pickup_weekday, cnt_df_hour$pickup_hour, sep = "_"), cnt_df_hour)
ggplot(cnt_df_hour, aes(x = combined_time, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
## summarise by hours
cnt_df_hour <- yellow_cleaned_type2 %>%
group_by(pickup_weekday, pickup_hour) %>%
count(pickup_hour) %>%
arrange(pickup_weekday, pickup_hour)
colnames(cnt_df_hour)[3] <- "freq"
## summarise by hours
cnt_df_hour <- yellow_cleaned_type2 %>%
group_by(pickup_weekday, pickup_hour) %>%
count(pickup_hour)
colnames(cnt_df_hour)[3] <- "freq"
cnt_df_hour$pickup_hour <- as.numeric(cnt_df_hour$pickup_hour)
cnt_df_hour <- arrange(cnt_df_hour, pickup_weekday, pickup_hour)
cnt_df_hour <- cbind(combined_time = paste(cnt_df_hour$pickup_weekday, cnt_df_hour$pickup_hour, sep = "_"), cnt_df_hour)
ggplot(cnt_df_hour, aes(x = combined_time, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
levels(cnt_df_hour$combined_time)
cnt_df_hour$combined_time <- as.factor(cnt_df_hour$pickup_hour)
levels(cnt_df_hour$combined_time)
## summarise by hours
cnt_df_hour <- yellow_cleaned_type2 %>%
group_by(pickup_weekday, pickup_hour) %>%
count(pickup_hour)
colnames(cnt_df_hour)[3] <- "freq"
cnt_df_hour$combined_time <- as.factor(cnt_df_hour$pickup_hour)
# cnt_df_hour <- arrange(cnt_df_hour, pickup_weekday, pickup_hour)
cnt_df_hour <- cbind(combined_time = paste(cnt_df_hour$pickup_weekday, cnt_df_hour$pickup_hour, sep = "_"), cnt_df_hour)
ggplot(cnt_df_hour, aes(x = combined_time, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
ggplot(cnt_df_hour, aes(x = combined_time, y = freq, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
?geom_bar
ggplot(cnt_df_hour, aes(x = combined_time, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="count") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
ggplot(cnt_df_hour, aes(x = combined_time, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar() +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
ggplot(cnt_df_hour, aes(x = combined_time, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="stack") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
ggplot(cnt_df_hour, aes(x = combined_time, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
# plot barplot
if(sel_viewByHour == FALSE){
ggplot(cnt_df, aes(x = combined_time, y = freq, fill = "#FA8072", alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
}else{
ggplot(cnt_df_hour, aes(x = combined_time, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="bin") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
}
ggplot(cnt_df_hour, aes(x = combined_time, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="bin") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
ggplot(cnt_df_hour, aes(x = combined_time, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
levels(cnt_df_hour$combined_time)
## summarise by hours
cnt_df_hour <- yellow_cleaned_type2 %>%
group_by(pickup_weekday, pickup_hour) %>%
count(pickup_hour)
colnames(cnt_df_hour)[3] <- "freq"
cnt_df_hour$combined_time <- as.factor(cnt_df_hour$pickup_hour)
# cnt_df_hour <- arrange(cnt_df_hour, pickup_weekday, pickup_hour)
cnt_df_hour <- cbind(combined_time = paste(cnt_df_hour$pickup_weekday, cnt_df_hour$pickup_hour, sep = "_"), cnt_df_hour)
levels(cnt_df_hour$combined_time)
cnt_df_hour$combined_time <- as.factor(cnt_df_hour$pickup_hour)
levels(cnt_df_hour$combined_time)
## summarise by hours
cnt_df_hour <- yellow_cleaned_type2 %>%
group_by(pickup_weekday, pickup_hour) %>%
count(pickup_hour)
colnames(cnt_df_hour)[3] <- "freq"
# cnt_df_hour <- arrange(cnt_df_hour, pickup_weekday, pickup_hour)
cnt_df_hour <- cbind(combined_time = paste(cnt_df_hour$pickup_weekday, cnt_df_hour$pickup_hour, sep = "_"), cnt_df_hour)
levels(cnt_df_hour$combined_time)
## summarise by hours
cnt_df_hour <- yellow_cleaned_type2 %>%
group_by(pickup_weekday, pickup_hour) %>%
count(pickup_hour)
colnames(cnt_df_hour)[3] <- "freq"
# cnt_df_hour <- arrange(cnt_df_hour, pickup_weekday, pickup_hour)
cnt_df_hour <- cbind(combined_time = paste(cnt_df_hour$pickup_weekday, cnt_df_hour$pickup_hour, sep = "_"), cnt_df_hour)
cnt_df_hour$combined_time <- as.factor(cnt_df_hour$combined_time)
levels(cnt_df_hour$combined_time)
cnt_df_hour$pickup_hour <- as.character(cnt_df_hour$pickup_hour)
## summarise by hours
cnt_df_hour <- yellow_cleaned_type2 %>%
group_by(pickup_weekday, pickup_hour) %>%
count(pickup_hour)
colnames(cnt_df_hour)[3] <- "freq"
cnt_df_hour$pickup_hour <- as.character(cnt_df_hour$pickup_hour)
cnt_df_hour <- cbind(combined_time = paste(cnt_df_hour$pickup_weekday, cnt_df_hour$pickup_hour, sep = "_"), cnt_df_hour)
View(cnt_df_hour)
length(15)
length(as.character(15))
as.character(15)
ggplot(cnt_df_hour, aes(x = pickup_hour, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
## summarise by hours
cnt_df_hour <- yellow_cleaned_type2 %>%
group_by(pickup_weekday, pickup_hour) %>%
count(pickup_hour)
colnames(cnt_df_hour)[3] <- "freq"
cnt_df_hour <- cbind(combined_time = paste(cnt_df_hour$pickup_weekday, cnt_df_hour$pickup_hour, sep = "_"), cnt_df_hour)
ggplot(cnt_df_hour, aes(x = pickup_hour, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
sel_weekday <- c("mon", "tue")#sel_item2
## summarise by hours
cnt_df_hour <- yellow_cleaned_type2 %>%
group_by(pickup_weekday, pickup_hour) %>%
count(pickup_hour) %>%
arrange(pickup_weekday, pickup_hour)
colnames(cnt_df_hour)[3] <- "freq"
cnt_df_hour <- cbind(combined_time = paste(cnt_df_hour$pickup_weekday, cnt_df_hour$pickup_hour, sep = "_"), cnt_df_hour)
## summarise by hours
cnt_df_hour <- yellow_cleaned_type2 %>%
group_by(pickup_weekday, pickup_hour) %>%
count(pickup_hour)
colnames(cnt_df_hour)[3] <- "freq"
cnt_df_hour <- cbind(combined_time = paste(cnt_df_hour$pickup_weekday, cnt_df_hour$pickup_hour, sep = "_"), cnt_df_hour)
ggplot(cnt_df_hour, aes(x = pickup_hour, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
View(cnt_df_hour)
# filter by restricting conditions
yellow_cleaned_type2 <- if(sel_isWeekend == 2){ # mixed
filter(df_data,
pickup_weekday %in% sel_weekday)
}else if(sel_isWeekend == 0){ # weekday
filter(yellow_june_cleaned,
isWeekend == FALSE,
pickup_weekday %in% sel_weekday,
workTime %in% sel_timeInDay)
}else{#(sel_isWeekend == 1){ # weekend
filter(yellow_june_cleaned, #df_data,
isWeekend == TRUE,
pickup_weekday %in% sel_weekday,
weekendTime %in% sel_timeInDay)
}
## summarise by hours
cnt_df_hour <- yellow_cleaned_type2 %>%
group_by(pickup_weekday, pickup_hour) %>%
count(pickup_hour)
colnames(cnt_df_hour)[3] <- "freq"
cnt_df_hour <- cbind(combined_time = paste(cnt_df_hour$pickup_weekday, cnt_df_hour$pickup_hour, sep = "_"), cnt_df_hour)
ggplot(cnt_df_hour, aes(x = pickup_hour, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.position = "none")
ggplot(cnt_df_hour, aes(x = pickup_hour, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1))#,
ggplot(cnt_df_hour, aes(x = pickup_hour, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank())
ggplot(cnt_df_hour, aes(x = pickup_hour, y = freq, fill = cnt_df_hour$pickup_weekday), alpha = 0.5) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank())
ggplot(cnt_df_hour, aes(x = pickup_hour, y = freq, fill = cnt_df_hour$pickup_weekday), alpha = 0.5) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
axis.text.x = element_text(hjust = 1),
legend.title = element_blank())
ggplot(cnt_df_hour, aes(x = pickup_hour, y = freq, fill = cnt_df_hour$pickup_weekday), alpha = 0.5) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
# axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank())
ggplot(cnt_df_hour, aes(x = pickup_hour, y = freq), fill = cnt_df_hour$pickup_weekday, alpha = 0.5) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
# axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank())
ggplot(cnt_df_hour, aes(x = pickup_hour, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5), show.legend = F) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
# axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank())
ggplot(cnt_df_hour, aes(x = pickup_hour, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
# axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank())
ggplot(cnt_df_hour, aes(x = pickup_hour, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
# axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank()) + guides(alpha=FALSE)
ggplot(cnt_df_hour, aes(x = pickup_hour, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
# axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank()) +
guides(alpha=FALSE)
sel_weekday <- c("mon","tue","wed","thu","fri")#sel_item2
## summarise by hours
cnt_df_hour <- yellow_cleaned_type2 %>%
group_by(pickup_weekday, pickup_hour) %>%
count(pickup_hour)
colnames(cnt_df_hour)[3] <- "freq"
cnt_df_hour <- cbind(combined_time = paste(cnt_df_hour$pickup_weekday, cnt_df_hour$pickup_hour, sep = "_"), cnt_df_hour)
ggplot(cnt_df_hour, aes(x = pickup_hour, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
# axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank()) +
guides(alpha=FALSE) # remove specific legend
# legend.position = "none")
}
# filter by restricting conditions
yellow_cleaned_type2 <- if(sel_isWeekend == 2){ # mixed
filter(df_data,
pickup_weekday %in% sel_weekday)
}else if(sel_isWeekend == 0){ # weekday
filter(yellow_june_cleaned,
isWeekend == FALSE,
pickup_weekday %in% sel_weekday,
workTime %in% sel_timeInDay)
}else{#(sel_isWeekend == 1){ # weekend
filter(df_data, #df_data,
isWeekend == TRUE,
pickup_weekday %in% sel_weekday,
weekendTime %in% sel_timeInDay)
}
## summarise by hours
cnt_df_hour <- yellow_cleaned_type2 %>%
group_by(pickup_weekday, pickup_hour) %>%
count(pickup_hour)
colnames(cnt_df_hour)[3] <- "freq"
cnt_df_hour <- cbind(combined_time = paste(cnt_df_hour$pickup_weekday, cnt_df_hour$pickup_hour, sep = "_"), cnt_df_hour)
ggplot(cnt_df_hour, aes(x = pickup_hour, y = freq, fill = cnt_df_hour$pickup_weekday, alpha = 0.5)) +
ggtitle("Frequency of Pickup Times on Workdays (by logical time)") +
geom_bar(stat="identity") +
theme(panel.background = element_rect(fill = "#E0F5FF",
colour = "#E0F5FF",
size = 0.5, linetype = "solid"),
plot.title = element_text(color="black", size=20, face="bold.italic", hjust = 0.5),
# axis.text.x = element_text(angle = 45, hjust = 1),
legend.title = element_blank()) +
guides(alpha=FALSE) # remove specific legend
runApp('D:/finalProjectData/RShiny/NYCTaxiVis')
runApp('D:/finalProjectData/RShiny/NYCTaxiVis')
runApp()
runApp('D:/finalProjectData/RShiny/NYCTaxiVis')
?updateCheckboxGroupInput
runApp('D:/finalProjectData/RShiny/NYCTaxiVis')
runApp('D:/finalProjectData/RShiny/NYCTaxiVis')
runApp('D:/finalProjectData/RShiny/NYCTaxiVis')
runApp('D:/finalProjectData/RShiny/NYCTaxiVis')
# collect dropped variables
rm(vec_ID,
vec_dropoff_day,
vec_dropoff_hour,
vec_dropoff_month,
vec_dropoff_time,
vec_dropoff_weekday,
vec_isWeekend,
vec_pickup_day,
vec_pickup_hour,
vec_pickup_month,
vec_pickup_time,
vec_pickup_weekday,
vec_travel_time_sec,
vec_weekend_index,
vec_weekend_time,
vec_weekendTime,
vec_workday_index,
vec_workday_time,
vec_workdayTime
)
rm(sel_isWeekend)
rm(sel_timeInDay)
rm(sel_weekday)
?deployApp()
deployApp()
rsconnect::deployApp()
rsconnect::deployApp("D:\\finalProjectData\\RShiny\\NYCTaxiVis")
gc()
library(shiny)
library(shinyjs)
runGitHub("nyc-yellow-taxi-vis", "Forrest-Li")
runGitHub("nyc-yellow-taxi-vis", "Forrest-Li")
setwd("D:/finalProjectData/RShiny/NYCTaxiVis")
runGitHub("nyc-yellow-taxi-vis", "Forrest-Li")
